<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>El Almacén v57 - Corrección Total</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 10px; }
        .btn-pago { border: 2px solid #e5e7eb; transition: all 0.2s; cursor: pointer; }
        .active-efectivo { border-color: #22c55e !important; background-color: #f0fdf4 !important; transform: scale(1.05); }
        .active-transf { border-color: #3b82f6 !important; background-color: #eff6ff !important; transform: scale(1.05); }
        .active-tarjeta { border-color: #ef4444 !important; background-color: #fef2f2 !important; transform: scale(1.05); }
        .input-cantidad { width: 115px !important; height: 45px !important; font-size: 16px !important; border: 2px solid #3b82f6 !important; text-align: center; font-weight: 900; border-radius: 12px; }
    </style>
</head>
<body class="h-screen flex overflow-hidden">

    <div id="modal-pass" class="hidden fixed inset-0 bg-black/60 z-[100] flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white p-8 rounded-[2rem] shadow-2xl text-center w-85 border-2 border-blue-100">
            <i class="fas fa-lock text-blue-500 text-4xl mb-4"></i>
            <h3 class="font-black uppercase text-sm mb-4">Acceso Protegido</h3>
            <input type="password" id="pass-input" placeholder="••••••••" class="w-full p-4 border-2 rounded-2xl mb-6 text-center font-bold text-xl outline-none focus:border-blue-500 bg-gray-50 shadow-inner">
            <div class="flex gap-3">
                <button onclick="cerrarModal()" class="flex-1 bg-gray-100 py-3 rounded-xl font-black text-[10px] uppercase">Cancelar</button>
                <button onclick="validarPass()" class="flex-1 bg-blue-600 text-white py-3 rounded-xl font-black text-[10px] uppercase shadow-lg">Entrar</button>
            </div>
        </div>
    </div>

    <div class="w-72 bg-white shadow-xl flex flex-col z-20 text-center border-r">
        <div class="p-6 border-b border-gray-100 relative">
            <div class="relative inline-block">
                <img id="app-logo" src="OIP.webp" alt="Logo" class="mx-auto mb-4 w-32 h-32 rounded-full shadow-lg border-2 border-blue-50 object-cover">
                <label class="absolute bottom-4 right-0 bg-blue-600 text-white p-2 rounded-full cursor-pointer shadow-md hover:bg-blue-700 transition">
                    <i class="fas fa-camera text-xs"></i>
                    <input type="file" class="hidden" onchange="cambiarLogo(event)">
                </label>
            </div>
            <h1 class="text-lg font-black text-blue-600 uppercase tracking-tighter leading-tight">EL ALMACÉN <br><span class="text-gray-400 text-xs italic">del Repostero</span></h1>
            <div class="mt-2 space-y-1">
                <p class="text-[8px] text-gray-400 font-bold uppercase italic tracking-tighter text-center">Sarmiento 2201 - Marcos Paz</p>
                <p class="text-[8px] text-gray-400 font-bold uppercase italic tracking-tighter text-center">Constituyente 400 - Mariano Acosta</p>
            </div>
        </div>
        <nav class="flex-1 px-4 py-4 space-y-1">
            <button onclick="showSection('pos')" class="w-full flex items-center p-4 hover:bg-blue-50 rounded-2xl transition font-bold text-gray-600"><i class="fas fa-cash-register mr-3 text-blue-500"></i> Ventas</button>
            <button onclick="abrirModalPass('inventory')" class="w-full flex items-center p-4 hover:bg-blue-50 rounded-2xl transition font-bold text-gray-600"><i class="fas fa-boxes mr-3 text-blue-500"></i> Inventario</button>
            <button onclick="abrirModalPass('reports')" class="w-full flex items-center p-4 hover:bg-blue-50 rounded-2xl transition font-bold text-gray-600"><i class="fas fa-file-invoice-dollar mr-3 text-blue-500"></i> Auditoría</button>
            <button onclick="showSection('totals')" class="w-full flex items-center p-4 hover:bg-blue-50 rounded-2xl transition font-bold text-gray-600"><i class="fas fa-chart-line mr-3 text-blue-500"></i> Totales Diarios</button>
            <button onclick="showSection('weekly')" class="w-full flex items-center p-4 hover:bg-blue-50 rounded-2xl transition font-bold text-gray-600"><i class="fas fa-list-ol mr-3 text-yellow-500"></i> Prod. Semanal</button>
        </nav>
        <div class="p-4 border-t text-center"><div id="reloj" class="text-[10px] font-black text-blue-900 uppercase"></div></div>
    </div>

    <div class="flex-1 flex flex-col overflow-hidden">
        <header class="bg-white p-6 shadow-sm border-b px-10">
            <div class="relative w-full max-w-lg mx-auto text-center">
                <i class="fas fa-search absolute left-4 top-4 text-gray-400"></i>
                <input type="text" id="buscador" onkeyup="filtrarProductos()" placeholder="Buscar productos..." class="w-full pl-12 pr-6 py-3 border-2 border-gray-100 rounded-2xl font-bold bg-gray-50 outline-none focus:border-blue-500">
            </div>
        </header>
        <main id="main-content" class="
